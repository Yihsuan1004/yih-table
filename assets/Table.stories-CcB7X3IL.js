import{r as m}from"./index-DJO9vBfz.js";import{r as Re}from"./index-DLC2J04D.js";var fe={exports:{}},P={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Oe=m,Ie=Symbol.for("react.element"),je=Symbol.for("react.fragment"),ke=Object.prototype.hasOwnProperty,ze=Oe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,qe={key:!0,ref:!0,__self:!0,__source:!0};function pe(n,a,e){var s,t={},r=null,i=null;e!==void 0&&(r=""+e),a.key!==void 0&&(r=""+a.key),a.ref!==void 0&&(i=a.ref);for(s in a)ke.call(a,s)&&!qe.hasOwnProperty(s)&&(t[s]=a[s]);if(n&&n.defaultProps)for(s in a=n.defaultProps,a)t[s]===void 0&&(t[s]=a[s]);return{$$typeof:Ie,type:n,key:r,ref:i,props:t,_owner:ze.current}}P.Fragment=je;P.jsx=pe;P.jsxs=pe;fe.exports=P;var h=fe.exports,T=(n=>(n.DESCEND="descend",n.ASCEND="ascend",n))(T||{});function I(n,a,e){let s=e.initialDeps??[],t;return()=>{var r,i,o,l;let c;e.key&&((r=e.debug)!=null&&r.call(e))&&(c=Date.now());const u=n();if(!(u.length!==s.length||u.some((f,g)=>s[g]!==f)))return t;s=u;let p;if(e.key&&((i=e.debug)!=null&&i.call(e))&&(p=Date.now()),t=a(...u),e.key&&((o=e.debug)!=null&&o.call(e))){const f=Math.round((Date.now()-c)*100)/100,g=Math.round((Date.now()-p)*100)/100,y=g/16,b=(x,D)=>{for(x=String(x);x.length<D;)x=" "+x;return x};console.info(`%c⏱ ${b(g,5)} /${b(f,5)} ms`,`
            font-size: .6rem;
            font-weight: bold;
            color: hsl(${Math.max(0,Math.min(120-120*y,120))}deg 100% 31%);`,e==null?void 0:e.key)}return(l=e==null?void 0:e.onChange)==null||l.call(e,t),t}}function V(n,a){if(n===void 0)throw new Error("Unexpected undefined");return n}const _e=(n,a)=>Math.abs(n-a)<1,$e=(n,a,e)=>{let s;return function(...t){n.clearTimeout(s),s=n.setTimeout(()=>a.apply(this,t),e)}},Ae=n=>n,Pe=n=>{const a=Math.max(n.startIndex-n.overscan,0),e=Math.min(n.endIndex+n.overscan,n.count-1),s=[];for(let t=a;t<=e;t++)s.push(t);return s},Le=(n,a)=>{const e=n.scrollElement;if(!e)return;const s=n.targetWindow;if(!s)return;const t=i=>{const{width:o,height:l}=i;a({width:Math.round(o),height:Math.round(l)})};if(t(e.getBoundingClientRect()),!s.ResizeObserver)return()=>{};const r=new s.ResizeObserver(i=>{const o=i[0];if(o!=null&&o.borderBoxSize){const l=o.borderBoxSize[0];if(l){t({width:l.inlineSize,height:l.blockSize});return}}t(e.getBoundingClientRect())});return r.observe(e,{box:"border-box"}),()=>{r.unobserve(e)}},U={passive:!0},Fe=typeof window>"u"?!0:"onscrollend"in window,Be=(n,a)=>{const e=n.scrollElement;if(!e)return;const s=n.targetWindow;if(!s)return;let t=0;const r=Fe?()=>{}:$e(s,()=>{a(t,!1)},n.options.isScrollingResetDelay),i=c=>()=>{t=e[n.options.horizontal?"scrollLeft":"scrollTop"],r(),a(t,c)},o=i(!0),l=i(!1);return l(),e.addEventListener("scroll",o,U),e.addEventListener("scrollend",l,U),()=>{e.removeEventListener("scroll",o),e.removeEventListener("scrollend",l)}},Ve=(n,a,e)=>{if(a!=null&&a.borderBoxSize){const s=a.borderBoxSize[0];if(s)return Math.round(s[e.options.horizontal?"inlineSize":"blockSize"])}return Math.round(n.getBoundingClientRect()[e.options.horizontal?"width":"height"])},He=(n,{adjustments:a=0,behavior:e},s)=>{var t,r;const i=n+a;(r=(t=s.scrollElement)==null?void 0:t.scrollTo)==null||r.call(t,{[s.options.horizontal?"left":"top"]:i,behavior:e})};class We{constructor(a){this.unsubs=[],this.scrollElement=null,this.targetWindow=null,this.isScrolling=!1,this.scrollToIndexTimeoutId=null,this.measurementsCache=[],this.itemSizeCache=new Map,this.pendingMeasuredCacheIndexes=[],this.scrollRect=null,this.scrollOffset=null,this.scrollDirection=null,this.scrollAdjustments=0,this.elementsCache=new Map,this.observer=(()=>{let e=null;const s=()=>e||(!this.targetWindow||!this.targetWindow.ResizeObserver?null:e=new this.targetWindow.ResizeObserver(t=>{t.forEach(r=>{this._measureElement(r.target,r)})}));return{disconnect:()=>{var t;return(t=s())==null?void 0:t.disconnect()},observe:t=>{var r;return(r=s())==null?void 0:r.observe(t,{box:"border-box"})},unobserve:t=>{var r;return(r=s())==null?void 0:r.unobserve(t)}}})(),this.range=null,this.setOptions=e=>{Object.entries(e).forEach(([s,t])=>{typeof t>"u"&&delete e[s]}),this.options={debug:!1,initialOffset:0,overscan:1,paddingStart:0,paddingEnd:0,scrollPaddingStart:0,scrollPaddingEnd:0,horizontal:!1,getItemKey:Ae,rangeExtractor:Pe,onChange:()=>{},measureElement:Ve,initialRect:{width:0,height:0},scrollMargin:0,gap:0,indexAttribute:"data-index",initialMeasurementsCache:[],lanes:1,isScrollingResetDelay:150,enabled:!0,...e}},this.notify=(e,s)=>{var t,r;const{startIndex:i,endIndex:o}=this.range??{startIndex:void 0,endIndex:void 0},l=this.calculateRange();(e||i!==(l==null?void 0:l.startIndex)||o!==(l==null?void 0:l.endIndex))&&((r=(t=this.options).onChange)==null||r.call(t,this,s))},this.cleanup=()=>{this.unsubs.filter(Boolean).forEach(e=>e()),this.unsubs=[],this.scrollElement=null,this.targetWindow=null,this.observer.disconnect(),this.elementsCache.clear()},this._didMount=()=>()=>{this.cleanup()},this._willUpdate=()=>{var e;const s=this.options.enabled?this.options.getScrollElement():null;if(this.scrollElement!==s){if(this.cleanup(),!s){this.notify(!1,!1);return}this.scrollElement=s,this.scrollElement&&"ownerDocument"in this.scrollElement?this.targetWindow=this.scrollElement.ownerDocument.defaultView:this.targetWindow=((e=this.scrollElement)==null?void 0:e.window)??null,this._scrollToOffset(this.getScrollOffset(),{adjustments:void 0,behavior:void 0}),this.unsubs.push(this.options.observeElementRect(this,t=>{this.scrollRect=t,this.notify(!1,!1)})),this.unsubs.push(this.options.observeElementOffset(this,(t,r)=>{this.scrollAdjustments=0,this.scrollDirection=r?this.getScrollOffset()<t?"forward":"backward":null,this.scrollOffset=t;const i=this.isScrolling;this.isScrolling=r,this.notify(i!==r,r)}))}},this.getSize=()=>this.options.enabled?(this.scrollRect=this.scrollRect??this.options.initialRect,this.scrollRect[this.options.horizontal?"width":"height"]):(this.scrollRect=null,0),this.getScrollOffset=()=>this.options.enabled?(this.scrollOffset=this.scrollOffset??(typeof this.options.initialOffset=="function"?this.options.initialOffset():this.options.initialOffset),this.scrollOffset):(this.scrollOffset=null,0),this.getFurthestMeasurement=(e,s)=>{const t=new Map,r=new Map;for(let i=s-1;i>=0;i--){const o=e[i];if(t.has(o.lane))continue;const l=r.get(o.lane);if(l==null||o.end>l.end?r.set(o.lane,o):o.end<l.end&&t.set(o.lane,!0),t.size===this.options.lanes)break}return r.size===this.options.lanes?Array.from(r.values()).sort((i,o)=>i.end===o.end?i.index-o.index:i.end-o.end)[0]:void 0},this.getMeasurementOptions=I(()=>[this.options.count,this.options.paddingStart,this.options.scrollMargin,this.options.getItemKey,this.options.enabled],(e,s,t,r,i)=>(this.pendingMeasuredCacheIndexes=[],{count:e,paddingStart:s,scrollMargin:t,getItemKey:r,enabled:i}),{key:!1}),this.getMeasurements=I(()=>[this.getMeasurementOptions(),this.itemSizeCache],({count:e,paddingStart:s,scrollMargin:t,getItemKey:r,enabled:i},o)=>{var l;if(!i)return this.measurementsCache=[],this.itemSizeCache.clear(),[];this.measurementsCache.length===0&&(this.measurementsCache=this.options.initialMeasurementsCache,this.measurementsCache.forEach(d=>{this.itemSizeCache.set(d.key,d.size)}));const c=this.pendingMeasuredCacheIndexes.length>0?Math.min(...this.pendingMeasuredCacheIndexes):0;this.pendingMeasuredCacheIndexes=[];const u=this.measurementsCache.slice(0,c);for(let d=c;d<e;d++){let p=(l=this.measurementsCache[d])==null?void 0:l.measureElement;p||(p=S=>{const E=r(d),v=this.elementsCache.get(E);if(!S){v&&(this.observer.unobserve(v),this.elementsCache.delete(E));return}v!==S&&(v&&this.observer.unobserve(v),this.observer.observe(S),this.elementsCache.set(E,S)),S.isConnected&&this.resizeItem(d,this.options.measureElement(S,void 0,this))});const f=r(d),g=this.options.lanes===1?u[d-1]:this.getFurthestMeasurement(u,d),y=g?g.end+this.options.gap:s+t,b=o.get(f),x=typeof b=="number"?b:this.options.estimateSize(d),D=y+x,O=g?g.lane:d%this.options.lanes;u[d]={index:d,start:y,size:x,end:D,key:f,lane:O,measureElement:p}}return this.measurementsCache=u,u},{key:!1,debug:()=>this.options.debug}),this.calculateRange=I(()=>[this.getMeasurements(),this.getSize(),this.getScrollOffset()],(e,s,t)=>this.range=e.length>0&&s>0?Ue({measurements:e,outerSize:s,scrollOffset:t}):null,{key:!1,debug:()=>this.options.debug}),this.getIndexes=I(()=>[this.options.rangeExtractor,this.calculateRange(),this.options.overscan,this.options.count],(e,s,t,r)=>s===null?[]:e({startIndex:s.startIndex,endIndex:s.endIndex,overscan:t,count:r}),{key:!1,debug:()=>this.options.debug}),this.indexFromElement=e=>{const s=this.options.indexAttribute,t=e.getAttribute(s);return t?parseInt(t,10):(console.warn(`Missing attribute name '${s}={index}' on measured element.`),-1)},this._measureElement=(e,s)=>{const t=this.indexFromElement(e),r=this.getMeasurements()[t];if(!r||!e.isConnected){this.elementsCache.forEach((o,l)=>{o===e&&(this.observer.unobserve(e),this.elementsCache.delete(l))});return}const i=this.elementsCache.get(r.key);i!==e&&(i&&this.observer.unobserve(i),this.observer.observe(e),this.elementsCache.set(r.key,e)),this.resizeItem(t,this.options.measureElement(e,s,this))},this.resizeItem=(e,s)=>{const t=this.getMeasurements()[e];if(!t)return;const r=this.itemSizeCache.get(t.key)??t.size,i=s-r;i!==0&&((this.shouldAdjustScrollPositionOnItemSizeChange!==void 0?this.shouldAdjustScrollPositionOnItemSizeChange(t,i,this):t.start<this.getScrollOffset()+this.scrollAdjustments)&&this._scrollToOffset(this.getScrollOffset(),{adjustments:this.scrollAdjustments+=i,behavior:void 0}),this.pendingMeasuredCacheIndexes.push(t.index),this.itemSizeCache=new Map(this.itemSizeCache.set(t.key,s)),this.notify(!0,!1))},this.measureElement=e=>{e&&this._measureElement(e,void 0)},this.getVirtualItems=I(()=>[this.getIndexes(),this.getMeasurements()],(e,s)=>{const t=[];for(let r=0,i=e.length;r<i;r++){const o=e[r],l=s[o];t.push(l)}return t},{key:!1,debug:()=>this.options.debug}),this.getVirtualItemForOffset=e=>{const s=this.getMeasurements();if(s.length!==0)return V(s[ge(0,s.length-1,t=>V(s[t]).start,e)])},this.getOffsetForAlignment=(e,s)=>{const t=this.getSize(),r=this.getScrollOffset();s==="auto"&&(e<=r?s="start":e>=r+t?s="end":s="start"),s==="start"?e=e:s==="end"?e=e-t:s==="center"&&(e=e-t/2);const i=this.options.horizontal?"scrollWidth":"scrollHeight",l=(this.scrollElement?"document"in this.scrollElement?this.scrollElement.document.documentElement[i]:this.scrollElement[i]:0)-t;return Math.max(Math.min(l,e),0)},this.getOffsetForIndex=(e,s="auto")=>{e=Math.max(0,Math.min(e,this.options.count-1));const t=this.getMeasurements()[e];if(!t)return;const r=this.getSize(),i=this.getScrollOffset();if(s==="auto")if(t.end>=i+r-this.options.scrollPaddingEnd)s="end";else if(t.start<=i+this.options.scrollPaddingStart)s="start";else return[i,s];const o=s==="end"?t.end+this.options.scrollPaddingEnd:t.start-this.options.scrollPaddingStart;return[this.getOffsetForAlignment(o,s),s]},this.isDynamicMode=()=>this.elementsCache.size>0,this.cancelScrollToIndex=()=>{this.scrollToIndexTimeoutId!==null&&this.targetWindow&&(this.targetWindow.clearTimeout(this.scrollToIndexTimeoutId),this.scrollToIndexTimeoutId=null)},this.scrollToOffset=(e,{align:s="start",behavior:t}={})=>{this.cancelScrollToIndex(),t==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getOffsetForAlignment(e,s),{adjustments:void 0,behavior:t})},this.scrollToIndex=(e,{align:s="auto",behavior:t}={})=>{e=Math.max(0,Math.min(e,this.options.count-1)),this.cancelScrollToIndex(),t==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size.");const r=this.getOffsetForIndex(e,s);if(!r)return;const[i,o]=r;this._scrollToOffset(i,{adjustments:void 0,behavior:t}),t!=="smooth"&&this.isDynamicMode()&&this.targetWindow&&(this.scrollToIndexTimeoutId=this.targetWindow.setTimeout(()=>{if(this.scrollToIndexTimeoutId=null,this.elementsCache.has(this.options.getItemKey(e))){const[c]=V(this.getOffsetForIndex(e,o));_e(c,this.getScrollOffset())||this.scrollToIndex(e,{align:o,behavior:t})}else this.scrollToIndex(e,{align:o,behavior:t})}))},this.scrollBy=(e,{behavior:s}={})=>{this.cancelScrollToIndex(),s==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getScrollOffset()+e,{adjustments:void 0,behavior:s})},this.getTotalSize=()=>{var e;const s=this.getMeasurements();let t;return s.length===0?t=this.options.paddingStart:t=this.options.lanes===1?((e=s[s.length-1])==null?void 0:e.end)??0:Math.max(...s.slice(-this.options.lanes).map(r=>r.end)),t-this.options.scrollMargin+this.options.paddingEnd},this._scrollToOffset=(e,{adjustments:s,behavior:t})=>{this.options.scrollToFn(e,{behavior:t,adjustments:s},this)},this.measure=()=>{var e,s;this.itemSizeCache=new Map,(s=(e=this.options).onChange)==null||s.call(e,this,!1)},this.setOptions(a)}}const ge=(n,a,e,s)=>{for(;n<=a;){const t=(n+a)/2|0,r=e(t);if(r<s)n=t+1;else if(r>s)a=t-1;else return t}return n>0?n-1:0};function Ue({measurements:n,outerSize:a,scrollOffset:e}){const s=n.length-1,r=ge(0,s,o=>n[o].start,e);let i=r;for(;i<s&&n[i].end<e+a;)i++;return{startIndex:r,endIndex:i}}const Ke=typeof document<"u"?m.useLayoutEffect:m.useEffect;function Je(n){const a=m.useReducer(()=>({}),{})[1],e={...n,onChange:(t,r)=>{var i;r?Re.flushSync(a):a(),(i=n.onChange)==null||i.call(n,t,r)}},[s]=m.useState(()=>new We(e));return s.setOptions(e),m.useEffect(()=>s._didMount(),[]),Ke(()=>s._willUpdate()),s}function Ye(n){return Je({observeElementRect:Le,observeElementOffset:Be,scrollToFn:He,...n})}function Ze(n,a){const e=m.useRef(0),s=m.useRef(null);return m.useCallback((...t)=>{const r=Date.now();r-e.current>=a?(n(...t),e.current=r):(s.current&&clearTimeout(s.current),s.current=setTimeout(()=>{n(...t),e.current=Date.now()},a-(r-e.current)))},[n,a])}const Ge=({data:n,initialSortConfig:a,onTableChange:e})=>{const[s,t]=m.useState(a),r=(l,c,u,d)=>[...l].sort((f,g)=>{if(d&&typeof d=="function")return d(f,g,u);const y=f[c],b=g[c];return typeof y=="number"&&typeof b=="number"?u===T.ASCEND?y-b:b-y:typeof y=="string"&&typeof b=="string"?u===T.ASCEND?y.localeCompare(b):b.localeCompare(y):0}),i=m.useCallback((l,c)=>{let u=T.ASCEND;s.field===l&&s.sortOrder===T.ASCEND&&(u=T.DESCEND);const d={field:l,sortOrder:u};return t(d),c===!0?{data:n,sortConfig:d}:{data:r(n,l,u,typeof c=="function"?c:void 0),sortConfig:d}},[n,s]),o=m.useCallback((l,c)=>{const{data:u,sortConfig:d}=i(l,c);e({sorter:d,currentData:u})},[i,e]);return{onSort:i,sortConfig:s,handleSort:o}},Xe=()=>{const[n,a]=m.useState(0),[e,s]=m.useState(0),t=m.useRef(null);return m.useEffect(()=>{const r=()=>{const i=t.current;if(i){const o=i.getBoundingClientRect();s(o.height);const l=i.querySelector("tr");l&&a(l.getBoundingClientRect().height)}};return r(),window.addEventListener("resize",r),()=>{window.removeEventListener("resize",r)}},[]),{rowHeight:n,containerHeight:e,containerRef:t}},Qe=({externalRef1:n,externalRef2:a})=>{const e=m.useRef(null),s=m.useRef(null),t=n||e,r=a||s;return m.useEffect(()=>{const i=()=>{t.current&&r.current&&(console.log("handleScroll",t,r.current.scrollLeft),t.current.scrollLeft=r.current.scrollLeft,console.log("handleScroll",t.current.scrollLeft))},o=r.current;return o&&o.addEventListener("scroll",i),()=>{o&&o.removeEventListener("scroll",i)}},[t,r]),[t,r]},et=({virtualScroll:n,onScrollFetch:a,virtualizer:e,tableData:s,setTableData:t})=>{const[r,i]=m.useState(!1),[o,l]=m.useState(0),c=m.useRef(!0),u=m.useCallback(async()=>{if(!(!n||r||!c||!a)){i(!0);try{const{data:d,hasMore:p}=await a(o);if(d.length===0||!p)c.current=!1;else return l(f=>f+d.length),d}finally{i(!1)}}},[n,r,a,o]);return m.useEffect(()=>{if(!a||!e)return;const[d]=[...e.getVirtualItems()].reverse();d&&d.index>=s.length-1&&c.current&&!r&&u().then(p=>{p&&t(f=>[...f,...p])})},[u,r,e,s.length,a,t]),{loading:r,offset:o,setOffset:l,hasNextPage:c,handleScrollFetch:u}},tt="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20height='40px'%20viewBox='0%20-960%20960%20960'%20width='40px'%20fill='%235f6368'%3e%3cpath%20d='m280-400%20200-200.67L680-400H280Z'/%3e%3c/svg%3e",st="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20height='40px'%20viewBox='0%20-960%20960%20960'%20width='40px'%20fill='%235f6368'%3e%3cpath%20d='M480-360%20280-559.33h400L480-360Z'/%3e%3c/svg%3e",L=({column:n,row:a,colIndex:e,columns:s,isFixedLeft:t,isFixedRight:r,isHeader:i,onClick:o,tableState:l,scrollInfo:c})=>{var S,E,v;const u=m.useRef(null),[d,p]=m.useState(0),[f,g]=m.useState(0);m.useEffect(()=>{if(t||r){let w=0;if(t){for(let C=0;C<e;C++){const N=document.querySelector(`.col-${C}`);N&&(w+=N.offsetWidth)}p(w)}if(r){w=0;for(let C=s.length-1;C>e;C--){const N=document.querySelector(`.col-${C}`);N&&(w+=N.offsetWidth)}g(w)}}},[e,s,t,r]);const y=i?"th":"td",b=t&&e===s.filter(w=>w.fixed==="left").length-1,x=r&&e===s.length-s.filter(w=>w.fixed==="right").length,D=b&&(c==null?void 0:c.left)||!1,O=x&&(c==null?void 0:c.right)||!1;return h.jsx(y,{ref:u,style:{width:n.width,left:t?`${d}px`:void 0,right:r?`${f}px`:void 0},className:`
        yh-table-cell
        ${i?"yh-table-head":""}
        ${t?"sticky":""} 
        ${r?"sticky":""} 
        ${t||r?"z-10":""}
        ${b?"fixed-left-last":""}
        ${x?"fixed-right-first":""}
        ${(D||O)&&c?"show-shadow":""}
        col-${e}
      `,onClick:o,children:i?h.jsxs(h.Fragment,{children:[n.title,n.sortable&&h.jsx("span",{className:`sort-icon ${((S=l.sorter)==null?void 0:S.field)===n.field?"active":""}`,children:h.jsx("img",{src:((E=l.sorter)==null?void 0:E.sortOrder)===T.ASCEND?tt:st,alt:((v=l.sorter)==null?void 0:v.sortOrder)===T.ASCEND?"升序":"降序",className:"inline-block ml-1 w-4 h-4"})})]}):n.render?n.render(a[n.field],a):a[n.field]},n.field)};L.__docgenInfo={description:"",methods:[],displayName:"TableCell",props:{column:{required:!0,tsType:{name:"TableColumn"},description:""},colIndex:{required:!0,tsType:{name:"number"},description:""},columns:{required:!0,tsType:{name:"Array",elements:[{name:"TableColumn"}],raw:"TableColumn[]"},description:""},isFixedLeft:{required:!0,tsType:{name:"boolean"},description:""},isFixedRight:{required:!0,tsType:{name:"boolean"},description:""},row:{required:!1,tsType:{name:"any"},description:""},isHeader:{required:!1,tsType:{name:"boolean"},description:""},tableState:{required:!1,tsType:{name:"any"},description:""},scrollInfo:{required:!1,tsType:{name:"signature",type:"object",raw:"{ left: number; right: number }",signature:{properties:[{key:"left",value:{name:"number",required:!0}},{key:"right",value:{name:"number",required:!0}}]}},description:""},onClick:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""}}};const be=({columns:n,handleSort:a,tableState:e,scrollInfo:s,className:t,theadRef:r})=>h.jsx("div",{className:"yh-table-head-container",ref:r,children:h.jsxs("table",{className:`yh-table ${t}`,children:[h.jsx("colgroup",{children:n.map((i,o)=>h.jsx("col",{style:{width:i.width}},o))}),h.jsx("thead",{children:h.jsx("tr",{children:n.map((i,o)=>h.jsx(L,{column:i,colIndex:o,columns:n,isFixedLeft:i.fixed==="left",isFixedRight:i.fixed==="right",isHeader:!0,onClick:()=>i.sortable&&a(i.field,i.customSort),tableState:e,scrollInfo:s},i.field))})})]})});be.__docgenInfo={description:"",methods:[],displayName:"TableHeader",props:{columns:{required:!0,tsType:{name:'TableProps["columns"]',raw:'TableProps["columns"]'},description:""},handleSort:{required:!0,tsType:{name:"signature",type:"function",raw:"(field: string, customSort?: SortFunction) => void",signature:{arguments:[{type:{name:"string"},name:"field"},{type:{name:"union",raw:"((a: any, b: any, sortOrder: SortOrder) => number) | boolean",elements:[{name:"unknown"},{name:"boolean"}]},name:"customSort"}],return:{name:"void"}}},description:""},tableState:{required:!0,tsType:{name:"TableState"},description:""},className:{required:!1,tsType:{name:"string"},description:""},scrollInfo:{required:!0,tsType:{name:"signature",type:"object",raw:`{\r
  left: number;\r
  right: number;\r
}`,signature:{properties:[{key:"left",value:{name:"number",required:!0}},{key:"right",value:{name:"number",required:!0}}]}},description:""},theadRef:{required:!0,tsType:{name:"ReactRefObject",raw:"React.RefObject<HTMLDivElement>",elements:[{name:"HTMLDivElement"}]},description:""}}};const H=({index:n,className:a,row:e,columns:s})=>h.jsx("tr",{className:a,children:s.map((t,r)=>{const i=t.fixed==="left",o=t.fixed==="right";return h.jsx(L,{column:t,row:e,colIndex:r,columns:s,isFixedLeft:i,isFixedRight:o},t.field)})},n),ye=({virtualRow:n,index:a,className:e,row:s,columns:t,scrollInfo:r})=>h.jsx("tr",{className:e,style:{height:`${n==null?void 0:n.size}px`,transform:`translateY(${n.start-a*n.size}px)`},children:t.map((i,o)=>{const l=i.fixed==="left",c=i.fixed==="right";return h.jsx(L,{column:i,row:s,colIndex:o,columns:t,isFixedLeft:l,isFixedRight:c,scrollInfo:r},i.field)})},s.id);H.__docgenInfo={description:"",methods:[],displayName:"TableRow",props:{index:{required:!0,tsType:{name:"number"},description:""},className:{required:!1,tsType:{name:"string"},description:""},row:{required:!0,tsType:{name:"Record",elements:[{name:"K"},{name:"T"}],raw:"Record<K, T>"},description:""},virtualRow:{required:!1,tsType:{name:"VirtualItem",elements:[{name:"Element"}],raw:"VirtualItem<Element>"},description:""},columns:{required:!0,tsType:{name:"Array",elements:[{name:"TableColumn"}],raw:"TableColumn[]"},description:""},scrollInfo:{required:!1,tsType:{name:"signature",type:"object",raw:"{ left: number; right: number }",signature:{properties:[{key:"left",value:{name:"number",required:!0}},{key:"right",value:{name:"number",required:!0}}]}},description:""}}};ye.__docgenInfo={description:"",methods:[],displayName:"VirtualTableRow",props:{index:{required:!0,tsType:{name:"number"},description:""},className:{required:!1,tsType:{name:"string"},description:""},row:{required:!0,tsType:{name:"Record",elements:[{name:"K"},{name:"T"}],raw:"Record<K, T>"},description:""},virtualRow:{required:!1,tsType:{name:"VirtualItem",elements:[{name:"Element"}],raw:"VirtualItem<Element>"},description:""},columns:{required:!0,tsType:{name:"Array",elements:[{name:"TableColumn"}],raw:"TableColumn[]"},description:""},scrollInfo:{required:!1,tsType:{name:"signature",type:"object",raw:"{ left: number; right: number }",signature:{properties:[{key:"left",value:{name:"number",required:!0}},{key:"right",value:{name:"number",required:!0}}]}},description:""}}};const xe=({virtualScroll:n,rowHeight:a,containerHeight:e,virtualizer:s,tableData:t,className:r,columns:i,hasNextPage:o,tbodyRef:l,scrollInfo:c,onScroll:u,hasOnScrollFetch:d})=>h.jsx("div",{ref:l,className:"yh-table-container",onScroll:u,children:n?h.jsx("div",{style:{height:`${s.getTotalSize()}px`},children:h.jsx("table",{className:`yh-table ${r}`,children:h.jsx("tbody",{children:n&&a>0&&e>0?s.getVirtualItems().map((p,f)=>{const g=t[p.index];return p.index>=t.length?h.jsx("tr",{style:{height:`${a}px`,transform:`translateY(${p.start-f*p.size}px)`},children:h.jsx("td",{colSpan:i.length,className:"yh-table-loader",children:d&&o.current?h.jsx("div",{className:"yh-css-loader mx-auto"}):d?"無更多資料":null})},`loader-${f}`):h.jsx(ye,{index:f,row:g,virtualRow:p,columns:i,scrollInfo:c},(g==null?void 0:g.id)||f)}):t.map((p,f)=>h.jsx(H,{index:f,row:p,columns:i,scrollInfo:c},f))})})}):h.jsx("table",{className:"yh-table",children:h.jsx("tbody",{children:t.map((p,f)=>h.jsx(H,{index:f,row:p,columns:i,scrollInfo:c},f))})})});xe.__docgenInfo={description:"",methods:[],displayName:"TableBody",props:{virtualScroll:{required:!0,tsType:{name:"boolean"},description:""},rowHeight:{required:!0,tsType:{name:"number"},description:""},containerHeight:{required:!0,tsType:{name:"number"},description:""},virtualizer:{required:!0,tsType:{name:"Virtualizer",elements:[{name:"any"},{name:"any"}],raw:"Virtualizer<any, any>"},description:""},className:{required:!1,tsType:{name:"string"},description:""},tableData:{required:!0,tsType:{name:"Array",elements:[{name:"any"}],raw:"any[]"},description:""},columns:{required:!0,tsType:{name:'TableProps["columns"]',raw:'TableProps["columns"]'},description:""},hasNextPage:{required:!0,tsType:{name:"ReactMutableRefObject",raw:"React.MutableRefObject<boolean>",elements:[{name:"boolean"}]},description:""},tbodyRef:{required:!0,tsType:{name:"ReactRefObject",raw:"React.RefObject<HTMLDivElement>",elements:[{name:"HTMLDivElement"}]},description:""},scrollInfo:{required:!0,tsType:{name:"signature",type:"object",raw:"{ left: number; right: number }",signature:{properties:[{key:"left",value:{name:"number",required:!0}},{key:"right",value:{name:"number",required:!0}}]}},description:""},onScroll:{required:!1,tsType:{name:"signature",type:"function",raw:"(event: React.UIEvent<HTMLDivElement>) => void",signature:{arguments:[{type:{name:"ReactUIEvent",raw:"React.UIEvent<HTMLDivElement>",elements:[{name:"HTMLDivElement"}]},name:"event"}],return:{name:"void"}}},description:""},hasOnScrollFetch:{required:!0,tsType:{name:"boolean"},description:""}}};const we=({columns:n,className:a,headClassName:e,bodyClassName:s,onChange:t,onScrollFetch:r,data:i,virtualScroll:o=!1})=>{const[l,c]=m.useState(i),[u,d]=m.useState({sorter:{field:"",sortOrder:T.DESCEND},currentData:[]}),{rowHeight:p,containerHeight:f,containerRef:g}=Xe(),[y,b]=m.useState({left:0,right:0}),[x,D]=Qe({externalRef1:void 0,externalRef2:g}),O=m.useRef(null),S=m.useCallback(M=>{const R=M.target;b({left:R.scrollLeft,right:R.scrollWidth-R.clientWidth-R.scrollLeft})},[]),E=Ze(S,100),{setOffset:v,hasNextPage:w,handleScrollFetch:C,loading:N}=et({virtualScroll:o,onScrollFetch:r,virtualizer:O.current,tableData:l,setTableData:c}),B=Ye({count:w?l.length+1:l.length,getScrollElement:()=>g.current,estimateSize:()=>50,overscan:5,onChange:M=>{const[R]=[...M.getVirtualItems()].reverse();R&&R.index>=l.length-1&&w&&!N&&C()}});m.useEffect(()=>{O.current=B},[B]);const De=M=>{c(M.currentData||[]),d(M),t==null||t(M)},{sortConfig:W,handleSort:Ne}=Ge({data:i,initialSortConfig:u.sorter,onTableChange:De});return m.useEffect(()=>{d(M=>({...M,sorter:W}))},[W]),m.useEffect(()=>{v(i.length),c(i||[])},[i]),h.jsxs("div",{className:`yh-table-outer-container ${a}`,children:[h.jsx(be,{className:e,theadRef:x,columns:n,handleSort:Ne,tableState:u,scrollInfo:y}),h.jsx(xe,{className:s,virtualScroll:o,rowHeight:p,containerHeight:f,virtualizer:B,tableData:l,columns:n,hasNextPage:w,tbodyRef:D,scrollInfo:y,onScroll:E,hasOnScrollFetch:!!r})]})};we.__docgenInfo={description:"",methods:[],displayName:"Table",props:{data:{required:!0,tsType:{name:"Array",elements:[{name:"Record",elements:[{name:"K"},{name:"T"}],raw:"Record<K, T>"}],raw:"RecordType[]"},description:""},columns:{required:!0,tsType:{name:"Array",elements:[{name:"TableColumn"}],raw:"TableColumn[]"},description:""},virtualScroll:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},className:{required:!1,tsType:{name:"string"},description:""},headClassName:{required:!1,tsType:{name:"string"},description:""},bodyClassName:{required:!1,tsType:{name:"string"},description:""},onChange:{required:!1,tsType:{name:"signature",type:"function",raw:"(state: TableState) => void",signature:{arguments:[{type:{name:"TableState"},name:"state"}],return:{name:"void"}}},description:""},onScrollFetch:{required:!1,tsType:{name:"signature",type:"function",raw:"(offset: number, limit?: number) => Promise<ScrollFetchDataResult<T>>",signature:{arguments:[{type:{name:"number"},name:"offset"},{type:{name:"number"},name:"limit"}],return:{name:"Promise",elements:[{name:"signature",type:"object",raw:`{\r
  data: T[];\r
  nextOffset: number; // 下一個偏移量\r
  hasMore: boolean; // 是否還有更多資料\r
}`,signature:{properties:[{key:"data",value:{name:"Array",elements:[{name:"T"}],raw:"T[]",required:!0}},{key:"nextOffset",value:{name:"number",required:!0}},{key:"hasMore",value:{name:"boolean",required:!0}}]}}],raw:"Promise<ScrollFetchDataResult<T>>"}}},description:""}}};const Se=n=>{const a=["John Doe","Jane Smith","Michael Brown","Alice Johnson","Chris Lee","Emma Wilson"],e=[];for(let s=1;s<=n;s++){const t=a[Math.floor(Math.random()*a.length)],r=Math.floor(Math.random()*60)+18;e.push({id:"#"+s,name:`${t} ${s}`,age:r})}return e},nt=n=>{const a=[],e=["待付款","已付款","配送中","已完成","已取消","退貨中"],s=["信用卡","PayPal","銀行轉帳","貨到付款"],t=["標準配送","快速配送","超商取貨","國際運送"],r=["電子產品","服飾","家居用品","食品","書籍","運動用品"],i=["供應商A","供應商B","供應商C","供應商D","供應商E"],o=["官網","實體店面","第三方平台","社交媒體"],l=["北部倉庫","中部倉庫","南部倉庫","東部倉庫"],c=["新客戶","回頭客","VIP客戶","企業客戶"];for(let u=0;u<n;u++){const d=new Date(Date.now()-Math.floor(Math.random()*365*24*60*60*1e3)),p=Math.floor(Math.random()*10)+1,f=Math.floor(Math.random()*1e3)+100,g=p*f;a.push({orderId:`ORD${String(u+1).padStart(6,"0")}`,orderDate:d.toISOString().split("T")[0],customerName:`客戶${u+1}`,totalAmount:g,status:e[Math.floor(Math.random()*e.length)],paymentMethod:s[Math.floor(Math.random()*s.length)],shippingMethod:t[Math.floor(Math.random()*t.length)],trackingNumber:`TRK${Math.random().toString(36).substr(2,9).toUpperCase()}`,productName:`商品${u+1}`,sku:`SKU${String(u+1).padStart(6,"0")}`,quantity:p,unitPrice:f,discount:Math.floor(Math.random()*20),tax:Math.floor(g*.05),shippingAddress:`地址${u+1}`,phoneNumber:`09${Math.floor(Math.random()*1e8).toString().padStart(8,"0")}`,email:`customer${u+1}@example.com`,returnStatus:Math.random()>.9?"已退貨":"未退貨",refundAmount:Math.random()>.9?Math.floor(g*Math.random()):0,stockLevel:Math.floor(Math.random()*100),category:r[Math.floor(Math.random()*r.length)],supplier:i[Math.floor(Math.random()*i.length)],lastUpdated:new Date().toISOString().split("T")[0],rating:(Math.random()*5).toFixed(1),reviewCount:Math.floor(Math.random()*100),promotionCode:Math.random()>.7?`PROMO${Math.random().toString(36).substr(2,6).toUpperCase()}`:"",profitMargin:(Math.random()*.5).toFixed(2),salesChannel:o[Math.floor(Math.random()*o.length)],warehouseLocation:l[Math.floor(Math.random()*l.length)],customerType:c[Math.floor(Math.random()*c.length)]})}return a},ve=n=>h.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${n==="上架"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:n}),Te=(n,a)=>h.jsx("img",{src:n,alt:a.name,className:"w-20 h-20 object-cover rounded-md"}),Ce=(n,a)=>h.jsx("button",{className:"bg-blue-500 text-white px-2 py-1 rounded-md",onClick:()=>alert(`你點擊了${a.name}欄位的動作${n}`),children:n}),F=[{id:"PRD001",name:"智能手機 X1",stock:150,status:"上架",action:"編輯",image:"./prod-images/手機.jfif"},{id:"PRD002",name:"筆記本電腦 Pro",stock:75,status:"上架",action:"編輯",image:"./prod-images/筆記本電腦.jpg"},{id:"PRD003",name:"無線耳機 AirPods",stock:200,status:"上架",action:"編輯",image:"./prod-images/無線耳機.jfif"},{id:"PRD004",name:"4K 超高清電視",stock:30,status:"下架",action:"編輯",image:"./prod-images/4K電視.jpg"},{id:"PRD005",name:"智能手錶 Series 5",stock:100,status:"上架",action:"編輯",image:"./prod-images/智能手錶.jfif"},{id:"PRD006",name:"遊戲主機 NextGen",stock:50,status:"上架",action:"編輯",image:"./prod-images/遊戲主機.jpg"},{id:"PRD007",name:"數位相機 D3500",stock:25,status:"下架",action:"編輯",image:"./prod-images/數位相機.jpg"},{id:"PRD008",name:"藍牙音箱 SoundMax",stock:80,status:"上架",action:"編輯",image:"./prod-images/藍牙音箱.jfif"},{id:"PRD009",name:"平板電腦 Tab A",stock:60,status:"上架",action:"編輯",image:"./prod-images/平板電腦.jfif"},{id:"PRD010",name:"智能燈泡",stock:40,status:"下架",action:"編輯",image:"./prod-images/智能燈泡.jpg"}],Me=[{field:"id",title:"商品ID",sortable:!0},{field:"name",title:"商品名稱",sortable:!0},{field:"image",title:"商品圖片",width:150,render:(n,a)=>h.jsx("img",{src:n,alt:a.name,className:"w-20 h-20 object-cover rounded-md"})},{field:"stock",title:"庫存",sortable:!0},{field:"status",title:"狀態",width:100,render:n=>h.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${n==="上架"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:n})},{field:"action",title:"操作",fixed:"right",render:(n,a)=>h.jsx("button",{className:"bg-blue-500 text-white px-2 py-1 rounded-md",onClick:()=>alert(`You clicked ${n} for ${a.name}`),children:n})}],rt=(n,a,e)=>{const s=n.name.length,t=a.name.length;return e===T.ASCEND?s-t:t-s},it=[{field:"id",title:"商品ID"},{field:"name",title:"商品名稱",sortable:!0,customSort:!0},{field:"image",title:"商品圖片",width:150,render:Te},{field:"stock",title:"庫存"},{field:"status",title:"狀態",width:100,render:ve},{field:"action",title:"操作",fixed:"right",render:Ce}],at=[{field:"id",title:"商品ID"},{field:"name",title:"商品名稱",sortable:!0,customSort:rt},{field:"image",title:"商品圖片",width:150,render:Te},{field:"stock",title:"庫存"},{field:"status",title:"狀態",width:100,render:ve},{field:"action",title:"操作",fixed:"right",render:Ce}],ot=n=>{alert(`將Table State內的sorter回傳給後端: ${JSON.stringify(n.sorter)}`)},lt=[{field:"orderId",title:"訂單編號",width:120,fixed:"left"},{field:"orderDate",title:"下單日期",width:110,fixed:"left"},{field:"customerName",title:"客戶姓名",width:150},{field:"totalAmount",title:"訂單金額",width:100},{field:"status",title:"訂單狀態",width:100},{field:"paymentMethod",title:"付款方式",width:120},{field:"shippingMethod",title:"配送方式",width:120},{field:"trackingNumber",title:"追蹤號碼",width:130},{field:"productName",title:"商品名稱",width:200},{field:"sku",title:"SKU",width:100},{field:"quantity",title:"數量",width:80},{field:"unitPrice",title:"單價",width:90},{field:"discount",title:"折扣",width:80},{field:"tax",title:"稅額",width:80},{field:"shippingAddress",title:"收貨地址",width:250},{field:"phoneNumber",title:"聯絡電話",width:120},{field:"email",title:"電子郵件",width:180},{field:"returnStatus",title:"退貨狀態",width:100},{field:"refundAmount",title:"退款金額",width:100},{field:"stockLevel",title:"庫存水平",width:100},{field:"category",title:"商品類別",width:120},{field:"supplier",title:"供應商",width:150},{field:"lastUpdated",title:"最後更新",width:110},{field:"rating",title:"商品評分",width:90},{field:"reviewCount",title:"評論數",width:90},{field:"promotionCode",title:"促銷代碼",width:110},{field:"profitMargin",title:"利潤率",width:90},{field:"salesChannel",title:"銷售渠道",width:120},{field:"warehouseLocation",title:"倉庫位置",width:130,fixed:"right"},{field:"customerType",title:"客戶類型",width:100,fixed:"right"}],Ee=[{field:"id",title:"ID"},{field:"name",title:"Name"},{field:"age",title:"Age"}],ct=nt(100),dt=Se(1e3),ut=Se(50),ht=async(n,a)=>{console.log(`Fetching more data from offset and limit: ${n} ${a}`);const e=[{id:"N"+n+3,name:`New Data ${n+3}`,age:31},{id:"N"+n+4,name:`New Data ${n+4}`,age:32},{id:"N"+n+5,name:`New Data ${n+5}`,age:33},{id:"N"+n+6,name:`New Data ${n+6}`,age:34}],s=n+e.length,t=s<60;return new Promise(r=>{setTimeout(()=>{r({data:e,nextOffset:s,hasMore:t})},1e3)})},pt={title:"Components/Table",component:we,parameters:{layout:"centered"},argTypes:{data:{description:"表格資料"},columns:{description:"表格欄位設定"},virtualScroll:{description:"是否啟用虛擬滾動"},className:{description:"表格樣式"},headClassName:{description:"表格標題樣式"},bodyClassName:{description:"表格內容樣式"},onChange:{description:"表格資料改變時的callback函數"},onScrollFetch:{description:"虛擬滾動時的callback函數"}},decorators:[n=>h.jsx("div",{style:{margin:"3em"},children:h.jsx(n,{})})],args:{className:"w-[800px] h-[300px]"},tags:["autodocs"]},j={args:{data:F,columns:Me,className:"w-[800px] h-[300px]"}},k={args:{data:F,columns:Me,className:"w-[800px] h-[300px]"}},z={args:{data:F,columns:it,onChange:ot,className:"w-[800px] h-[300px]"}},q={args:{data:F,columns:at,className:"w-[800px] h-[300px]"}},_={args:{data:ct,columns:lt,virtualScroll:!0,className:"w-[800px] h-[300px]"}},$={args:{data:dt,columns:Ee,virtualScroll:!0,className:"w-[800px] h-[300px]"}},A={args:{data:ut,columns:Ee,virtualScroll:!0,onScrollFetch:ht,className:"w-[800px] h-[300px]"}};var K,J,Y;j.parameters={...j.parameters,docs:{...(K=j.parameters)==null?void 0:K.docs,source:{originalSource:`{
  args: {
    data: sampleData,
    columns,
    className: "w-[800px] h-[300px]"
  }
}`,...(Y=(J=j.parameters)==null?void 0:J.docs)==null?void 0:Y.source}}};var Z,G,X;k.parameters={...k.parameters,docs:{...(Z=k.parameters)==null?void 0:Z.docs,source:{originalSource:`{
  args: {
    data: sampleData,
    columns,
    className: "w-[800px] h-[300px]"
  }
}`,...(X=(G=k.parameters)==null?void 0:G.docs)==null?void 0:X.source}}};var Q,ee,te;z.parameters={...z.parameters,docs:{...(Q=z.parameters)==null?void 0:Q.docs,source:{originalSource:`{
  args: {
    data: sampleData,
    columns: backendColumns,
    onChange: handleTableStateChange,
    className: "w-[800px] h-[300px]"
  }
}`,...(te=(ee=z.parameters)==null?void 0:ee.docs)==null?void 0:te.source}}};var se,ne,re;q.parameters={...q.parameters,docs:{...(se=q.parameters)==null?void 0:se.docs,source:{originalSource:`{
  args: {
    data: sampleData,
    columns: customColumns,
    className: "w-[800px] h-[300px]"
  }
}`,...(re=(ne=q.parameters)==null?void 0:ne.docs)==null?void 0:re.source}}};var ie,ae,oe;_.parameters={..._.parameters,docs:{...(ie=_.parameters)==null?void 0:ie.docs,source:{originalSource:`{
  args: {
    data: ecommerceData,
    columns: ecommerceColumns,
    virtualScroll: true,
    className: "w-[800px] h-[300px]"
  }
}`,...(oe=(ae=_.parameters)==null?void 0:ae.docs)==null?void 0:oe.source}}};var le,ce,de;$.parameters={...$.parameters,docs:{...(le=$.parameters)==null?void 0:le.docs,source:{originalSource:`{
  args: {
    data: virtualSampleData,
    columns: virtualScrollColumns,
    virtualScroll: true,
    className: "w-[800px] h-[300px]"
  }
}`,...(de=(ce=$.parameters)==null?void 0:ce.docs)==null?void 0:de.source}}};var ue,he,me;A.parameters={...A.parameters,docs:{...(ue=A.parameters)==null?void 0:ue.docs,source:{originalSource:`{
  args: {
    data: virtualSampleData2,
    columns: virtualScrollColumns,
    virtualScroll: true,
    onScrollFetch: handleScrollFetch,
    className: "w-[800px] h-[300px]"
  }
}`,...(me=(he=A.parameters)==null?void 0:he.docs)==null?void 0:me.source}}};const gt=["BasicTable","DefaultSort","BackendSort","CustomSort","FixedColumns","VirtualScroll","InfiniteScroll"];export{z as BackendSort,j as BasicTable,q as CustomSort,k as DefaultSort,_ as FixedColumns,A as InfiniteScroll,$ as VirtualScroll,gt as __namedExportsOrder,pt as default};
